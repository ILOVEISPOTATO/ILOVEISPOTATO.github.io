<!DOCTYPE html>
<html>
<head>
    <title>Sujet</title>
</head>
<body>
    <h1 id="title"></h1>
    <p id="message"></p>
    <form id="replyForm">
        <label for="reply">Réponse:</label><br>
        <textarea id="reply" name="reply" required></textarea><br>
        <input type="submit" value="Répondre">
    </form>
    <h2>Réponses</h2>
    <div id="replies"></div>

    <script>
        var title = decodeURIComponent(window.location.search.substring(1).split('=')[1]);
        var topics = JSON.parse(localStorage.getItem('topics')) || [];
        var topic = topics.find(function(topic) { return topic.title === title; });
        document.getElementById('title').textContent = topic.title;
        document.getElementById('message').textContent = topic.message;

        document.getElementById('replyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var reply = document.getElementById('reply').value;
            topic.replies = topic.replies || [];
            topic.replies.push(reply);
            localStorage.setItem('topics', JSON.stringify(topics));
            displayReplies();
        });

        function displayReplies() {
            var repliesDiv = document.getElementById('replies');
            repliesDiv.innerHTML = '';
            for(var i = 0; i < topic.replies.length; i++) {
                var reply = document.createElement('p');
                reply.textContent = topic.replies[i];
                repliesDiv.appendChild(reply);
            }
        }

        displayReplies();
    </script>
</body>
</html>
